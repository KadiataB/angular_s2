<div class="container" style="max-width: 1200px; margin: 0 auto; padding: 12px 16px;">

  <!-- Titre -->
  <div style="display: flex; justify-content: center;">
    <div style="margin-bottom: 8px; width: 1000px; display: flex;justify-content: space-between;">
      <h1 class="page-title" style="font-size: 22px; margin-bottom: 4px;">
        Nouvel approvisionnement
      </h1>
      <a href="/"
        style="
          display: inline-flex;
          align-items: center;
          gap: 6px;
          border: 1px solid #16bbf2;
          color: #16bbf2;
          text-decoration: none;
          padding: 4px 10px;
          border-radius: 6px;
          font-size: 16px;
        ">
        ‚Üê Retour √† la liste
      </a>
    </div>
  </div>

  <!-- Grille principale -->
  <div style="display: flex; justify-content: center;">
    <div style="width: 100%; max-width: 1000px;">

      <!-- Informations g√©n√©rales -->
      <div class="card" style="padding: 12px 16px; margin-bottom: 12px;">
        <h2 class="section-title" style="font-size: 18px; margin-bottom: 8px;">Informations g√©n√©rales</h2>
        <div class="grid grid-2" style="gap: 8px;">
          <div class="form-group">
            <label class="form-label">Date d'approvisionnement</label>
            <input type="date" class="form-input" [value]="date()" (change)="onDateChange($event)">
            <small style="color: var(--text-light); font-size: 12px; display: block; margin-top: 4px;">
              La r√©f√©rence sera g√©n√©r√©e automatiquement
            </small>
          </div>

          <div class="form-group">
            <label class="form-label">Fournisseur</label>
            <select class="form-select" [value]="fournisseur()" (change)="fournisseur.set($any($event.target).value)">
              <option value="">S√©lectionner un fournisseur</option>
              <option *ngFor="let f of fournisseurs" [value]="f">{{ f }}</option>
            </select>
          </div>

          <div class="form-group" style="grid-column: span 2;">
            <label class="form-label">R√©f√©rence</label>
            <input type="text" placeholder="R√©f√©rence de l'approvisionnement" class="form-input" [value]="reference()"
              (input)="reference.set($any($event.target).value)" readonly
              style="background-color: var(--gray-50); color: var(--text-secondary);">
            <small style="color: var(--text-light); font-size: 12px; display: block; margin-top: 4px;">
              R√©f√©rence g√©n√©r√©e automatiquement
            </small>
          </div>

          <div class="form-group" style="grid-column: span 2;">
            <label class="form-label">Observations</label>
            <textarea placeholder="Observations ou commentaires sur cet approvisionnement" class="form-textarea"
              [value]="observations()" (input)="observations.set($any($event.target).value)"
              style="min-height: 60px;"></textarea>
          </div>
        </div>
      </div>

      <!-- D√©tails de l'approvisionnement -->
      <div class="card" style="padding: 12px 16px; margin-bottom: 12px;">
        <h2 class="section-title" style="font-size: 18px; margin-bottom: 8px;">D√©tails de l'approvisionnement</h2>

        <div class="grid grid-3" style="gap: 10px; margin-bottom: 8px;">
          <div class="form-group">
            <label class="form-label">Article</label>
            <select class="form-select" [value]="article()" (change)="article.set($any($event.target).value)">
              <option value="">S√©lectionner un article</option>
              <option *ngFor="let a of articlesDisponibles" [value]="a">{{ a }}</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label">Quantit√©</label>
            <input type="number" class="form-input" [value]="quantite()"
              (input)="quantite.set(+$any($event.target).value)">
          </div>

          <div class="form-group">
            <label class="form-label">Prix unitaire (FCFA)</label>
            <input type="number" class="form-input" [value]="prixUnitaire()"
              (input)="prixUnitaire.set(+$any($event.target).value)">
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Montant total (FCFA)</label>
          <input [value]="montantTotalArticle() | number" disabled class="form-input"
            style="background-color: var(--gray-50);">
        </div>

        <!-- Boutons -->
        <div style="display: flex; align-items: center; gap: 20px; margin-top: 16px;">
          <button (click)="ajouterArticle()" class="btn btn-primary" style="flex: 0.5;">
            <span>+</span> Ajouter un autre article
          </button>

          <div style="display: flex; flex: 1; gap: 10px; justify-content: flex-end;">
            <button (click)="annuler()" class="btn btn-secondary" style="flex: 0.3;">
              Annuler
            </button>
            <button (click)="enregistrer()" class="btn btn-primary" style="flex: 0.7;">
              Enregistrer l'approvisionnement
            </button>
          </div>
        </div>
      </div>

      <!-- Articles ajout√©s -->
      <div class="card" style="padding: 12px 16px; margin-bottom: 12px;">
        <h2 class="section-title" style="font-size: 18px; margin-bottom: 8px;">Articles ajout√©s</h2>

        <table  style="width: 100%; border-collapse: collapse; margin-bottom: 12px;">
          <thead>
            <tr style="border-bottom: 1px solid var(--border);">
              <th style="text-align: left; padding: 8px 12px; font-weight: 600; color: var(--text-secondary);">Article</th>
              <th style="text-align: right; padding: 8px 12px; font-weight: 600; color: var(--text-secondary);">Quantit√©</th>
              <th style="text-align: right; padding: 8px 12px; font-weight: 600; color: var(--text-secondary);">Prix unitaire</th>
              <th style="text-align: right; padding: 8px 12px; font-weight: 600; color: var(--text-secondary);">Montant</th>
              <th style="text-align: center; padding: 8px 12px; font-weight: 600; color: var(--text-secondary);">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let article of articles()" style="border-bottom: 1px solid var(--border-light);">
              <td style="padding: 12px; font-weight: 500;">{{ article.nom }}</td>
              <td style="padding: 12px; text-align: right;">{{ article.quantite }}</td>
              <td style="padding: 12px; text-align: right;">{{ article.prixUnitaire | number }} FCFA</td>
              <td style="padding: 12px; text-align: right; font-weight: 500;">{{ article.montant | number }} FCFA</td>
              <td style="padding: 12px; text-align: center;">
                <button class="icon-btn" (click)="supprimerArticle(article.id)"
                  style="color: var(--error); font-size: 14px; border: none; background: none; cursor: pointer; padding: 4px;">
                  üóëÔ∏è
                </button>
              </td>
            </tr>
          </tbody>
        </table>

        <div style="border-top: 1px solid var(--border); padding-top: 10px; margin-top: 10px;">
          <div style="display: flex; justify-content: space-between; align-items: center; font-size: 15px; font-weight: 600;">
            <span>Total:</span>
            <span>{{ total() | number }} FCFA</span>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>
